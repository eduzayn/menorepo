<!-- cSpell:disable -->
# README TÃ‰CNICO - IntegraÃ§Ã£o Modular com Monorepo na Plataforma EdunÃ©xia

## VisÃ£o Geral
Este documento apresenta a arquitetura e estratÃ©gia de integraÃ§Ã£o dos mÃ³dulos da plataforma EdunÃ©xia, utilizando a abordagem **Monorepo com Workspaces**, com base nas tecnologias **Node.js, TypeScript e React**. O objetivo Ã© centralizar todos os mÃ³dulos da plataforma em um Ãºnico repositÃ³rio, mantendo autonomia de desenvolvimento, padronizaÃ§Ã£o de ferramentas e facilidade de integraÃ§Ã£o.

## O que Ã© Monorepo com Workspaces?
- **Monorepo** Ã© uma abordagem onde todos os projetos (mÃ³dulos) coexistem dentro de um Ãºnico repositÃ³rio Git.
- **Workspaces** permitem tratar cada mÃ³dulo como um pacote isolado, com suas prÃ³prias dependÃªncias e scripts, mas compartilhando configuraÃ§Ãµes e bibliotecas comuns.
- Utilizamos **pnpm Workspaces** como gerenciador de pacotes, com integraÃ§Ã£o com **Turborepo** para otimizaÃ§Ã£o de builds.

## Arquitetura TÃ©cnica da Plataforma
- **Backend**: Todos os mÃ³dulos utilizam o **Supabase** como backend e banco de dados. O banco Ã© Ãºnico e compartilhado por toda a plataforma, garantindo integridade e consistÃªncia dos dados.
- **Frontend**: As aplicaÃ§Ãµes front-end dos mÃ³dulos serÃ£o hospedadas na **Vercel**, permitindo implantaÃ§Ã£o rÃ¡pida, escalÃ¡vel e com integraÃ§Ã£o contÃ­nua via Git.

## Estrutura Modular do Monorepo
```bash
edunexia-monorepo/
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ material-didatico/
â”‚   â”œâ”€â”€ matriculas/
â”‚   â”œâ”€â”€ portal-do-aluno/
â”‚   â”œâ”€â”€ comunicacao/
â”‚   â”œâ”€â”€ financeiro-empresarial/
â”‚   â”œâ”€â”€ portal-parceiro/
â”‚   â”œâ”€â”€ portal-polo/
â”‚   â”œâ”€â”€ rh/
â”‚   â”œâ”€â”€ contabilidade/
â”‚   â”œâ”€â”€ site-edunexia/         # Site institucional, blog e vendas self-service
â”‚   â”œâ”€â”€ core/                  # MÃ³dulo central com componentes, hooks e utilitÃ¡rios compartilhados
â”‚   â””â”€â”€ module-template/       # Template para a criaÃ§Ã£o de novos mÃ³dulos
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ ui-components/         # Design System compartilhado
â”‚   â”œâ”€â”€ auth/                  # AutenticaÃ§Ã£o unificada (SSO)
â”‚   â”œâ”€â”€ database-schema/       # Tipos e schemas do banco de dados
â”‚   â””â”€â”€ api-client/            # Cliente de API unificado para comunicaÃ§Ã£o com o backend
â”œâ”€â”€ docs/                      # DocumentaÃ§Ã£o tÃ©cnica detalhada
â”‚   â”œâ”€â”€ arquitetura/           # Detalhes arquiteturais
â”‚   â”œâ”€â”€ workflows/             # Fluxos de trabalho e processos
â”‚   â””â”€â”€ guidelines/            # Diretrizes e melhores prÃ¡ticas
â”œâ”€â”€ .gitignore
â”œâ”€â”€ package.json               # Define os workspaces do Yarn
â”œâ”€â”€ tsconfig.json              # ConfiguraÃ§Ã£o TypeScript compartilhada
â”œâ”€â”€ CHANGELOG.md               # Registro de alteraÃ§Ãµes significativas
â””â”€â”€ README.md                  # Este documento
```

## Estado Atual do Desenvolvimento

### MÃ³dulos em Desenvolvimento Ativo
Os seguintes mÃ³dulos estÃ£o atualmente em desenvolvimento ativo:
- âœ… **core** - Base arquitetural e componentes compartilhados
- âœ… **portal-do-aluno** - Interface do estudante com features de documentos e notificaÃ§Ãµes
- âœ… **material-didatico** - Editor e visualizador de conteÃºdo didÃ¡tico
- âœ… **financeiro-empresarial** - GestÃ£o financeira institucional
- âœ… **comunicacao** - Mensageria, notificaÃ§Ãµes e CRM
- âœ… **matriculas** - Processo de inscriÃ§Ã£o e matrÃ­cula
- âœ… **site-edunexia** - Site institucional, blog e vendas self-service
- âœ… **rh** - GestÃ£o de recursos humanos, recrutamento e avaliaÃ§Ãµes de desempenho

### Pacotes Compartilhados Implementados
- âœ… **ui-components** - Sistema de design unificado
- âœ… **api-client** - Cliente padronizado para interaÃ§Ã£o com o backend
- âœ… **auth** - Sistema centralizado de autenticaÃ§Ã£o
- âœ… **database-schema** - DefiniÃ§Ãµes de tipos e modelos de dados

## MÃ³dulos Especiais e Infraestrutura

### Module-Template
Este mÃ³dulo serve como **referÃªncia e ponto de partida** para o desenvolvimento de novos mÃ³dulos:

- **module-template**: Um esqueleto inicial para a criaÃ§Ã£o de novos mÃ³dulos, contendo a estrutura de diretÃ³rios, arquivos bÃ¡sicos e exemplos funcionais. Deve ser copiado ao iniciar um novo mÃ³dulo para garantir que a estrutura padrÃ£o seja seguida.

### MÃ³dulo Core
O mÃ³dulo **core** desempenha um papel fundamental na arquitetura da plataforma:

- Centraliza componentes de layout, hooks e utilitÃ¡rios compartilhados entre todos os mÃ³dulos
- Fornece contextos globais para autenticaÃ§Ã£o, navegaÃ§Ã£o e notificaÃ§Ãµes
- Implementa abstraÃ§Ãµes para operaÃ§Ãµes comuns como chamadas de API e gerenciamento de estado
- Define padrÃµes arquiteturais para garantir consistÃªncia em toda a plataforma
- Unifica a experiÃªncia do usuÃ¡rio entre diferentes mÃ³dulos

Todos os mÃ³dulos devem importar e utilizar o `core` para manter a consistÃªncia da experiÃªncia e evitar duplicaÃ§Ã£o de cÃ³digo.

## Modelo de ComercializaÃ§Ã£o da Plataforma
A EdunÃ©xia serÃ¡ oferecida como uma **plataforma modular** para instituiÃ§Ãµes de EducaÃ§Ã£o a DistÃ¢ncia (EAD), especialmente **faculdades, centros universitÃ¡rios e universidades**. A proposta comercial Ã© flexÃ­vel e escalÃ¡vel:

### Planos Personalizados por Tamanho da InstituiÃ§Ã£o
- **InstituiÃ§Ãµes pequenas** poderÃ£o adquirir apenas os mÃ³dulos essenciais, como:
  - MÃ³dulo de ComunicaÃ§Ã£o
  - MÃ³dulo de MatrÃ­culas
  - Portal do Aluno

- **InstituiÃ§Ãµes maiores** poderÃ£o adquirir mÃ³dulos adicionais para uma gestÃ£o mais eficiente e completa:
  - Financeiro Empresarial
  - Portal do Polo
  - Portal do Parceiro
  - GestÃ£o de RH
  - Contabilidade
  - Material DidÃ¡tico (Editor Inteligente)

### Sistema de Vendas Autoatendimento
O **site-edunexia** funciona como site institucional e plataforma de vendas self-service, totalmente integrado ao ecossistema, com as seguintes funcionalidades:
- CatÃ¡logo de mÃ³dulos disponÃ­veis
- SimulaÃ§Ã£o de planos conforme escolha dos mÃ³dulos
- Cadastro automÃ¡tico da instituiÃ§Ã£o
- Pagamento on-line (via gateway)
- Acesso imediato por e-mail apÃ³s confirmaÃ§Ã£o
- **PerÃ­odo de testes gratuitos de 14 dias** para novos clientes

Este modelo permite que as instituiÃ§Ãµes realizem a contrataÃ§Ã£o sem depender de equipe de vendas, facilitando a escalabilidade do negÃ³cio.

## Estrutura PadrÃ£o dos MÃ³dulos
Todos os mÃ³dulos devem seguir rigorosamente a seguinte estrutura padronizada:

```
apps/nome-do-modulo/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/           # Componentes especÃ­ficos do mÃ³dulo
â”‚   â”‚   â””â”€â”€ index.ts         
â”‚   â”‚
â”‚   â”œâ”€â”€ contexts/             # Contextos especÃ­ficos (se necessÃ¡rio)
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                # Hooks especÃ­ficos do mÃ³dulo
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/                # PÃ¡ginas do mÃ³dulo
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ services/             # ServiÃ§os especÃ­ficos do mÃ³dulo
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                # UtilitÃ¡rios especÃ­ficos do mÃ³dulo
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ types/                # Tipos e interfaces
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ routes.tsx            # DefiniÃ§Ã£o de rotas do mÃ³dulo
â”‚   â””â”€â”€ index.tsx             # Ponto de entrada
â”‚
â”œâ”€â”€ package.json
â””â”€â”€ README.md                 # DocumentaÃ§Ã£o especÃ­fica
```

O cumprimento desta estrutura garante consistÃªncia e facilita a navegaÃ§Ã£o entre mÃ³dulos para todos os desenvolvedores do projeto.

## Diretrizes de ContribuiÃ§Ã£o

### ConvenÃ§Ãµes de CÃ³digo e Commits
- **Commits**: Use commits semÃ¢nticos no formato `tipo(escopo): descriÃ§Ã£o`, por exemplo:
  - `feat(portal-aluno): implementa sistema de notificaÃ§Ãµes`
  - `fix(financeiro): corrige cÃ¡lculo de juros em boletos atrasados`
  - `docs(readme): atualiza instruÃ§Ãµes de instalaÃ§Ã£o`

- **Branches**: Trabalhe diretamente na branch principal (`main`) para mÃ³dulos individuais, criando branches apenas para features complexas.

- **Code Style**: Siga as regras definidas no ESLint e Prettier do projeto.

### DocumentaÃ§Ã£o
- **README do mÃ³dulo**: Mantenha atualizado com:
  - VisÃ£o geral e propÃ³sito
  - Funcionalidades implementadas
  - Estrutura especÃ­fica
  - IntegraÃ§Ãµes com outros mÃ³dulos
  
- **JSDoc**: Documente todas as funÃ§Ãµes pÃºblicas, hooks, contexts e componentes principais.

### Desenvolvimento
- Reuse componentes do **ui-components** sempre que possÃ­vel
- Utilize o cliente **api-client** para todas as chamadas ao backend
- Implemente testes para todos os novos componentes e lÃ³gica de negÃ³cio
- **VerificaÃ§Ã£o ortogrÃ¡fica**: Para documentaÃ§Ã£o em portuguÃªs, utilize o script `scripts/fix-spelling.bat` para garantir que o verificador ortogrÃ¡fico esteja configurado corretamente. Mais detalhes em `docs/configuracao-ortografia.md`.

## EstratÃ©gia de IntegraÃ§Ã£o
1. CriaÃ§Ã£o da estrutura base do monorepo com Yarn Workspaces. âœ…
2. Desenvolvimento de cada mÃ³dulo como um workspace em `apps/`. âœ…
3. CriaÃ§Ã£o de bibliotecas reutilizÃ¡veis em `packages/` (ex: autenticaÃ§Ã£o, design system, API). âœ…
4. ConfiguraÃ§Ã£o de SSO (Single Sign-On) e compartilhamento de sessÃµes. ğŸ”„
5. PadronizaÃ§Ã£o de ferramentas de desenvolvimento: ESLint, Prettier, Husky, Vite, etc. âœ…

## ConsideraÃ§Ãµes TÃ©cnicas
- Gerenciamento de pacotes via `Yarn Workspaces` âœ…
- IntegraÃ§Ã£o contÃ­nua com CI/CD baseada em ramificaÃ§Ãµes por mÃ³dulo ğŸ”„
- AutenticaÃ§Ã£o JWT com SSO centralizado (em `packages/auth`) âœ…
- Compartilhamento de componentes em `ui-components` âœ…
- Uso de TypeScript em todos os mÃ³dulos e bibliotecas âœ…
- **Vite como ferramenta de build padrÃ£o para todos os mÃ³dulos** âœ…
  - Desenvolvimento rÃ¡pido com Hot Module Replacement (HMR)
  - Build optimizado para produÃ§Ã£o
  - Suporte nativo para TypeScript e React
  - ConfiguraÃ§Ã£o simplificada e extensÃ­vel
- **DetecÃ§Ã£o de dependÃªncias circulares com madge** âœ…
  - PrevenÃ§Ã£o de problemas de compilaÃ§Ã£o e funcionamento em tempo de execuÃ§Ã£o
  - VerificaÃ§Ã£o automatizada via scripts `circular:check` e `circular:check:all`
  - VisualizaÃ§Ã£o do grafo de dependÃªncias com `circular:image`
  - ExecutÃ¡vel via scripts `check-circular-deps.bat` ou `check-circular-deps.ps1`
- IntegraÃ§Ã£o com gateway de pagamento no mÃ³dulo `site-edunexia` ğŸ”„
- GeraÃ§Ã£o automÃ¡tica de credenciais e e-mails transacionais ğŸ”„
- Backend unificado no Supabase para todos os mÃ³dulos usando `@supabase/supabase-js` âœ…
- Deploy do frontend via Vercel com integraÃ§Ãµes automÃ¡ticas ğŸ”„
- Tipos e schemas centralizados em `database-schema` âœ…
- Cliente de API unificado em `api-client` para padronizaÃ§Ã£o de chamadas ao backend âœ…

## PrÃ³ximos Passos

### Curto Prazo (1-3 meses)
- Finalizar a implementaÃ§Ã£o das funcionalidades bÃ¡sicas dos mÃ³dulos prioritÃ¡rios
- Integrar completamente o sistema de autenticaÃ§Ã£o centralizada
- Implementar pipeline de CI/CD para todos os mÃ³dulos
- Continuar o desenvolvimento do mÃ³dulo de RH e suas integraÃ§Ãµes

### MÃ©dio Prazo (3-6 meses)
- Desenvolver mÃ³dulos secundÃ¡rios (Contabilidade)
- Finalizar a integraÃ§Ã£o do site-edunexia com o sistema de pagamentos
- Iniciar testes de integraÃ§Ã£o entre todos os mÃ³dulos
- Expandir as funcionalidades do mÃ³dulo de RH com folha de pagamento e benefÃ­cios

### Longo Prazo (6-12 meses)
- Completar a implementaÃ§Ã£o de todos os mÃ³dulos
- Realizar testes de carga e otimizaÃ§Ãµes de performance
- Preparar documentaÃ§Ã£o para parceiros e integradores

---

Com essa estrutura, a EdunÃ©xia evolui para um ecossistema educacional escalÃ¡vel, modular e tecnicamente moderno, pronto para atender instituiÃ§Ãµes de EAD de diferentes portes e necessidades, com possibilidade de contrataÃ§Ã£o automatizada por meio do site.

> **Nota:** Para informaÃ§Ãµes detalhadas sobre cada mÃ³dulo, consulte o README especÃ­fico dentro da pasta do mÃ³dulo correspondente.
> 
> Para detalhes tÃ©cnicos mais aprofundados, consulte a documentaÃ§Ã£o em `/docs`.

### ConfiguraÃ§Ãµes Compartilhadas

O monorepo inclui configuraÃ§Ãµes compartilhadas para garantir consistÃªncia entre os mÃ³dulos:

- **`packages/config-base/eslint`**: ConfiguraÃ§Ã£o base do ESLint para todos os mÃ³dulos
- **`packages/config-base/prettier`**: ConfiguraÃ§Ã£o base do Prettier para todos os mÃ³dulos  
- **`packages/tailwind-config`**: ConfiguraÃ§Ã£o base do Tailwind CSS para todos os mÃ³dulos

Cada mÃ³dulo deve estender essas configuraÃ§Ãµes conforme necessÃ¡rio. Consulte o [README do config-base](./packages/config-base/README.md) para mais detalhes.

## DivisÃ£o entre packages/core e apps/core

Para manter a organizaÃ§Ã£o e evitar duplicaÃ§Ã£o de cÃ³digo, definimos a seguinte separaÃ§Ã£o de responsabilidades:

### packages/core

- **DefiniÃ§Ã£o**: Biblioteca compartilhada com tipos, interfaces e constantes fundamentais
- **Escopo**: DefiniÃ§Ãµes globais do sistema que nÃ£o dependem de UI
- **Exemplos**: Tipos de usuÃ¡rio, funÃ§Ãµes utilitÃ¡rias puras, helpers de formataÃ§Ã£o
- **DependÃªncias**: MÃ­nimas, sem dependÃªncias de React ou UI
- **Uso**: Importado por todos os mÃ³dulos e outros pacotes

### apps/core

- **DefiniÃ§Ã£o**: MÃ³dulo contendo componentes React e lÃ³gica compartilhada
- **Escopo**: ImplementaÃ§Ãµes de UI, layouts, providers e componentes reutilizÃ¡veis
- **Exemplos**: Layouts, Providers (Auth, Theme), componentes de dashboard
- **DependÃªncias**: React, ui-components e outras bibliotecas de UI
- **Uso**: Importado apenas pelos mÃ³dulos de aplicaÃ§Ã£o

Esta separaÃ§Ã£o clara permite:
1. Melhor gerenciamento de dependÃªncias
2. CÃ³digo mais limpo e focado
3. Evitar dependÃªncias circulares
4. Melhor performance de build

> **Importante**: Qualquer cÃ³digo que nÃ£o dependa de React ou UI deve ser movido para `packages/core`. Componentes, hooks e contextos devem permanecer em `apps/core`.

## Testes Automatizados

Este monorepo utiliza Vitest e Jest para testes automatizados em todos os pacotes. Para garantir a qualidade do cÃ³digo, todos os pacotes devem incluir testes adequados.

### Executando testes

```bash
# Executar testes em todos os pacotes
pnpm test

# Executar testes em um pacote especÃ­fico
pnpm --filter @edunexia/[nome-do-pacote] test

# Executar testes com watch mode
pnpm --filter @edunexia/[nome-do-pacote] test:watch
```

### Cobertura de testes

Os relatÃ³rios de cobertura sÃ£o gerados automaticamente durante a execuÃ§Ã£o do CI e enviados para o Codecov.

### ConfiguraÃ§Ã£o de testes

Cada pacote contÃ©m sua prÃ³pria configuraÃ§Ã£o de testes, mas seguimos convenÃ§Ãµes comuns:

- Testes unitÃ¡rios em `__tests__/*.test.{ts,tsx,js,jsx}`
- ConfiguraÃ§Ã£o via `vite.config.js` ou `jest.config.js`
- Cobertura de cÃ³digo adequada, especialmente para funÃ§Ãµes crÃ­ticas
